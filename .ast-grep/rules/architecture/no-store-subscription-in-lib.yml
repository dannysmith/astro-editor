id: no-store-subscription-in-lib
message: |
  lib/ modules should use getState() for one-way store access, not subscriptions.

  ❌ BAD: const value = useEditorStore(state => state.value)
  ✅ GOOD: const value = useEditorStore.getState().value

  Store subscriptions (useStore()) create React coupling and should only be used
  in React components and hooks. lib/ modules should remain pure.
severity: error
language: typescript
files:
  - "src/lib/**/*.ts"
  - "src/lib/**/*.tsx"
rule:
  any:
    # Match: useEditorStore(selector)
    - pattern: useEditorStore($$$)
    - pattern: useProjectStore($$$)
    - pattern: useUIStore($$$)
    - pattern: useMdxComponentsStore($$$)
    - pattern: useComponentBuilderStore($$$)
note: |
  This enforces the Directory Boundaries rule from architecture-guide.md:

  lib/ can import from stores ONLY to use getState() - one-way data access
  without React coupling.

  Pattern:
  - ✅ useEditorStore.getState().value  (no subscription)
  - ❌ useEditorStore(state => state.value)  (subscription - React coupling)

  See: docs/developer/architecture-guide.md#directory-purpose-and-boundaries
  See: docs/developer/performance-patterns.md#getstate-pattern
